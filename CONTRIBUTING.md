# Contributing to Content Collector

感谢你对 **Content Collector** 的兴趣和贡献意愿 ❤️  
本项目欢迎 Issue、Bug 修复、文档改进和小型功能增强。

在提交 PR 之前，请花几分钟阅读以下说明。

## 📌 项目目标（请先了解）

Content Collector 是一个：

- **安全优先、稳定优先** 的 Laravel 爬虫基础包
- 数据库是**唯一真实状态源**
- Redis 仅作为加速器（可完全回退）
- Job 必须 **幂等、可重试**

👉 我们更看重 **可预测性**，而不是功能数量。

## 🧩 可以贡献什么？

欢迎以下类型的贡献：

- 🐛 Bug 修复
- 🧪 测试补充（Feature / Regression）
- 📝 文档改进
- 🔐 安全策略或边界问题修正
- ♻️ 小规模、明确收益的重构

请 **先开 Issue 讨论** 再提交以下内容：

- 新的爬取策略
- 改变 Task / Job 语义
- 修改数据库结构或状态流转

## ✅ 提交 PR 前「必须通过」

以下内容是 **强制要求**：

### 1 测试必须通过

```bash
composer test
```

- 所有 PR 必须 通过 PHPUnit
- 新功能或 Bug 修复 应包含对应测试

### 2 不允许破坏现有语义

请特别注意：

- Job 的职责边界
- Task 完成条件
- Redis 不可用时的回退行为
- 幂等性保证
  如果行为有变化，请在 PR 描述中明确说明。

## 🎨 代码风格（可选）

```bash
composer cs:chk
```

- 项目遵循 PSR-12
- CI 不会因风格问题失败
  -Maintainer 可能在合并前统一修复格式

## 🧪 覆盖率（维护者自用）

```bash
composer test:coverage
```

- 仅用于维护者评估
- 不要求贡献者提供覆盖率报告

## 🧠 设计约定（重要）

在修改代码时，请遵守以下原则：

- 数据库是最终真相
- Job 必须幂等
- Redis 不可成为唯一状态源
- 失败要显式、完成要明确
- 宁可少功能，也不要隐性状态

如果不确定某个设计是否符合原则，欢迎先提 Issue 讨论。

## 📝 Commit & PR 建议

- Commit message 请简洁明确
- PR 描述中请说明：
    - 解决了什么问题
    - 是否有行为变化
    - 是否影响现有 API / 任务流

## 🔐 安全问题

如果你发现 可能的安全问题（如 SSRF、RCE、数据泄露）：

- 请不要直接提交公开 Issue
- 通过 GitHub 私信或仓库提供的安全联系方式联系维护者

## 🙏 最后

感谢你花时间让这个项目变得更好。
我们希望 Content Collector 是一个：

> 可靠、可读、可维护，
> 即使一年后再看也不让人害怕的代码库。

欢迎你的贡献 🚀
